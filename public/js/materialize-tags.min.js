!function(t){"use strict";function e(e,i){this.itemsArray=[],this.$element=t(e),this.$element.hide(),this.objectItems=i&&i.itemValue,this.placeholderText=e.hasAttribute("placeholder")?this.$element.attr("placeholder"):"",this.inputSize=Math.max(1,this.placeholderText.length),this.$container=t('<div class="materialize-tags"></div>'),this.$input=t('<input type="text" class="n-tag"  placeholder="'+this.placeholderText+'"/>').appendTo(this.$container),this.$label=this.$element.parent().find("label"),this.$element.before(this.$container),this.build(i),this.$label.on("click",function(){t(this).addClass("active"),t(this).addClass("infocus"),t(this).next(".materialize-tags").find("input.n-tag").focus()}),this.$input.on("focus",function(){var e=t(this).parents(".materialize-tags").parent().find("label");t(this).parents(".materialize-tags").addClass("active"),+!e.hasClass("infocus")&&e.addClass("infocus"),e.hasClass("active")||e.addClass("active")}).on("focusout",function(){var e=t(this).parents(".materialize-tags"),i=e.find("span.chip");e.removeClass("active"),e.parent().find("label").removeClass("infocus"),0==i.length&&0==t(this).val().length&&e.parent().find("label").removeClass("active")})}function i(t,e){if("function"!=typeof t[e]){var i=t[e];t[e]=function(t){return t[i]}}}function a(t){return t?s.text(t).html():""}function n(t){var e=0;if(document.selection){t.focus();var i=document.selection.createRange();i.moveStart("character",-t.value.length),e=i.text.length}else(t.selectionStart||"0"==t.selectionStart)&&(e=t.selectionStart);return e}var r={tagClass:function(t){return"chip"},itemValue:function(t){return t?t.toString():t},itemText:function(t){return this.itemValue(t)},itemTitle:function(t){return null},freeInput:!0,addOnBlur:!0,maxTags:void 0,maxChars:void 0,confirmKeys:[9,13,44,188],onTagExists:function(t,e){e.hide().fadeIn()},trimValue:!0,allowDuplicates:!1,allowTabOnEmpty:!1,deleteTagsOnBackspace:!0,deleteTagsOnDeleteKey:!0,MoveTagOnLeftArrow:!0,MoveTagOnRightArrow:!0,autoselect:!1,CapitalizeFirstLetterOnly:!1};e.prototype={constructor:e,add:function(e,i,n){var r=this;if(!(r.options.maxTags&&r.itemsArray.length>=r.options.maxTags)&&(!1===e||e)){if("string"==typeof e&&r.options.trimValue&&(e=t.trim(e)),"string"==typeof e&&r.options.CapitalizeFirstLetterOnly&&(e=e.charAt(0).toUpperCase()+e.slice(1)),"object"==typeof e&&!r.objectItems)throw"Can't add objects when itemValue option is not set";if(!e.toString().match(/^\s*$/)){if("string"==typeof e&&"INPUT"===this.$element[0].tagName){var s=e.split(",");if(s.length>1){for(var o=0;o<s.length;o++)this.add(s[o],!0);return void(i||r.pushVal())}}var l=r.options.itemValue(e),p=r.options.itemText(e),u=r.options.tagClass(e),c=r.options.itemTitle(e);if(""!=p&&void 0!=p){var h=t.grep(r.itemsArray,function(t){return r.options.itemValue(t)===l})[0];if(!h||r.options.allowDuplicates){if(!(r.items().toString().length+e.length+1>r.options.maxInputLength)){var m=t.Event("beforeItemAdd",{item:e,cancel:!1,options:n});if(r.$element.trigger(m),!m.cancel){r.itemsArray.push(e);var f=t('<span class="'+a(u)+(null!==c?'" title="'+c:"")+'">'+a(p)+'<i class="material-icons" data-role="remove">close</i></span>');f.data("item",e),r.findInputWrapper().before(f),f.after(" "),i||r.pushVal(),r.options.maxTags!==r.itemsArray.length&&r.items().toString().length!==r.options.maxInputLength||(r.$container.addClass("materialize-tags-max"),r.$input.blur(),r.$input.prop("readOnly",!0)),r.$element.trigger(t.Event("itemAdded",{item:e,options:n}))}}}else if(r.options.onTagExists){var d=t(".tag",r.$container).filter(function(){return t(this).data("item")===h});r.options.onTagExists(e,d)}}}}},remove:function(e,i,a){var n=this;if(n.objectItems&&(e=(e="object"==typeof e?t.grep(n.itemsArray,function(t){return n.options.itemValue(t)==n.options.itemValue(e)}):t.grep(n.itemsArray,function(t){return n.options.itemValue(t)==e}))[e.length-1]),e){var r=t.Event("beforeItemRemove",{item:e,cancel:!1,options:a});if(n.$element.trigger(r),r.cancel)return;t(".chip",n.$container).filter(function(){return t(this).data("item")===e}).remove(),-1!==t.inArray(e,n.itemsArray)&&n.itemsArray.splice(t.inArray(e,n.itemsArray),1)}i||n.pushVal(),n.options.maxTags>n.itemsArray.length&&(n.$container.removeClass("materialize-tags-max"),n.$input.prop("readOnly",!1)),0==n.itemsArray.length&&n.$input.siblings("label").first().removeClass("active"),n.$input.blur(),n.$element.trigger(t.Event("itemRemoved",{item:e,options:a}))},removeAll:function(){for(t(".chip",this.$container).remove();this.itemsArray.length>0;)this.itemsArray.pop();this.pushVal(),this.$container.removeClass("materialize-tags-max"),this.$input.siblings("label").first().removeClass("active"),this.$input.prop("readOnly",!1),this.$input.blur()},refresh:function(){var e=this;t(".chip",e.$container).each(function(){var i=t(this),n=i.data("item"),r=(e.options.itemValue(n),e.options.itemText(n)),s=e.options.tagClass(n);i.attr("class",null),i.addClass("tag "+a(s)),i.contents().filter(function(){return 3==this.nodeType})[0].nodeValue=a(r)})},items:function(){return this.itemsArray},pushVal:function(){var e=this,i=t.map(e.items(),function(t){return e.options.itemValue(t).toString()});e.$element.val(i,!0).trigger("change"),e.$input.typeahead("val","")},build:function(e){var a=this;if(a.options=t.extend({},r,e),a.objectItems&&(!0===a.options.freeInput?a.options.freeInput=!0:a.options.freeInput=!1),i(a.options,"itemValue"),i(a.options,"itemText"),function(t,e){if("function"!=typeof t[e]){var i=t[e];t[e]=function(){return i}}}(a.options,"tagClass"),a.options.typeaheadjs){var s=null,o={},l=a.options.typeaheadjs;t.isArray(l)?(s=l[0],o=l[1]):o=l,a.$input.typeahead(s,o).on("typeahead:selected",t.proxy(function(t,e){o.valueKey?a.add(e[o.valueKey]):a.add(e),a.$input.typeahead("val","")},a))}a.$container.on("click",t.proxy(function(t){a.$element.attr("disabled")||a.$input.removeAttr("disabled"),a.$input.focus()},a)),a.options.addOnBlur&&a.options.freeInput&&a.$input.on("focusout",t.proxy(function(t){a.add(a.$input.val()),a.$input.val("")},a)),a.$container.on("keydown","input",t.proxy(function(e){var i=t(e.target),r=a.findInputWrapper();if(a.$element.attr("disabled"))a.$input.attr("disabled","disabled");else{switch(e.which){case 8:if(a.options.deleteTagsOnBackspace&&0===n(i[0])){var s=r.prev();s&&a.remove(s.data("item"))}break;case 46:if(a.options.deleteTagsOnDeleteKey&&0===n(i[0])){var o=r.next();o&&a.remove(o.data("item"))}break;case 37:var l=r.prev();a.options.MoveTagOnLeftArrow&&0===i.val().length&&l[0]&&(l.before(r),i.focus());break;case 39:var p=r.next();a.options.MoveTagOnRightArrow&&0===i.val().length&&p[0]&&(p.after(r),i.focus())}var u=i.val().length;Math.ceil(u/5),i.attr("size",Math.max(this.inputSize,i.val().length))}},a)),a.$container.on("keydown","input",t.proxy(function(e){var i=t(e.target);if(a.$element.attr("disabled"))a.$input.attr("disabled","disabled");else{var n=i.val(),r=a.options.maxChars&&n.length>=a.options.maxChars;if(!a.options.allowTabOnEmpty||(s=n,0!==s.length)||9!==e.which){var s;a.options.freeInput&&(function(e,i){var a=!1;return t.each(i,function(t,i){if("number"==typeof i&&e.which===i)return a=!0,!1;if(e.which===i.which){var n=!i.hasOwnProperty("altKey")||e.altKey===i.altKey,r=!i.hasOwnProperty("shiftKey")||e.shiftKey===i.shiftKey,s=!i.hasOwnProperty("ctrlKey")||e.ctrlKey===i.ctrlKey;if(n&&r&&s)return a=!0,!1}}),a}(e,a.options.confirmKeys)||r)&&(a.add(r?n.substr(0,a.options.maxChars):n),i.val(""),a.$input.typeahead&&a.$input.typeahead("val",""),e.preventDefault());var o=i.val().length;Math.ceil(o/5),i.attr("size",Math.max(this.inputSize,i.val().length))}}},a)),a.$container.on("click","[data-role=remove]",t.proxy(function(e){a.$element.attr("disabled")||a.remove(t(e.target).closest(".chip").data("item"))},a)),a.options.itemValue===r.itemValue&&"INPUT"===a.$element[0].tagName&&a.add(a.$element.val())},destroy:function(){this.$container.off("keydown","input"),this.$container.off("click","[role=remove]"),this.$container.remove(),this.$element.removeData("materialtags"),this.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var e=this.$input[0],i=this.$container[0];e&&e.parentNode!==i;)e=e.parentNode;return t(e)}},t.fn.materialtags=function(i,a,n){var r=[];return this.each(function(){var s=t(this).data("materialtags");if(s)if(i||a){if(void 0!==s[i]){if(3===s[i].length&&void 0!==n)var o=s[i](a,null,n);else o=s[i](a);void 0!==o&&r.push(o)}}else r.push(s);else s=new e(this,i),t(this).data("materialtags",s),r.push(s),t(this).val(t(this).val())}),"string"==typeof i?r.length>1?r:r[0]:r},t.fn.materialtags.defaults=r,t.fn.materialtags.Constructor=e;var s=t("<div />");t(function(){t("input[data-role=materialtags]").materialtags()})}(window.jQuery);